<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on January, 9  2008 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>JML Reference Manual: Compilation Units</TITLE>

<META NAME="description" CONTENT="JML Reference Manual: Compilation Units">
<META NAME="keywords" CONTENT="JML Reference Manual: Compilation Units">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC32"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_4.html#SEC25"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_6.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_28.html#SEC247">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>

<HR SIZE=2>
<H1> 5. Compilation Units </H1>
<!--docid::SEC32::-->
<P>

<A NAME="IDX1066"></A>
A compilation unit in JML is similar to that in Java, with some
additions.  It has the following syntax.
</P><P>

<A NAME="IDX1067"></A>
<A NAME="IDX1068"></A>
<A NAME="IDX1069"></A>
<A NAME="IDX1070"></A>
<A NAME="IDX1071"></A>
<A NAME="IDX1072"></A>
<A NAME="IDX1073"></A>
<A NAME="IDX1074"></A>
<TABLE><tr><td>&nbsp;</td><td class=display><pre style="font-family: serif"><VAR>compilation-unit</VAR> ::= [ <VAR>package-definition</VAR> ]
              [ <VAR>refine-prefix</VAR> ] 
              [ <VAR>import-definition</VAR> ] <small>...</small>
              [ <VAR>top-level-definition</VAR> ] <small>...</small>
<VAR>top-level-definition</VAR> ::= <VAR>type-definition</VAR>
        | <VAR>multijava-top-level-declaration</VAR>  <I>// When parsing MultiJava</I>
</pre></td></tr></table></P><P>

<A NAME="IDX1075"></A>
<A NAME="IDX1076"></A>
<A NAME="IDX1077"></A>
The <VAR>compilation-unit</VAR> rule is the start rule for the JML grammar.
(In this syntactic rule and in all other rules in the rest of the body
of this manual, <VAR>white-space</VAR> may appear between any two
tokens. See section <A HREF="jmlrefman_4.html#SEC25">4. Lexical Conventions</A>, for details.)
</P><P>

See section <A HREF="jmlrefman_6.html#SEC35">6. Type Definitions</A>, for the syntax and semantics of
<VAR>type-definition</VAR>s.
See section <A HREF="jmlrefman_17.html#SEC201">17.1 Augmenting Method Declarations</A>, for the syntax and semantics of 
<VAR>multijava-top-level-declaration</VAR>.
See section <A HREF="jmlrefman_16.html#SEC193">16. Refinement</A>, for a discussion of the <VAR>refine-prefix</VAR> and its uses.
</P><P>

<A NAME="IDX1078"></A>
<A NAME="IDX1079"></A>
<A NAME="IDX1080"></A>
<A NAME="IDX1081"></A>
<A NAME="IDX1082"></A>
Some JML tools may support various optional extensions to JML.  This
manual partially describes two such extensions:
MultiJava <A HREF="jmlrefman_27.html#BIB18">[Clifton-etal00]</A> 
and
the Universe type <A HREF="jmlrefman_27.html#BIB25">[Dietl-Mueller05]</A>.
Comments in the grammar indicate optional productions; these are only
used by tools that select an option to parse the syntax in question.
Tools for JML do not have to support these extensions to JML, and may
themselves support other JML extensions.  In general, JML tools will
support a (hopefully well-documented) variant of the language described
in this manual.
</P><P>

<A NAME="IDX1083"></A>
<A NAME="IDX1084"></A>
<A NAME="IDX1085"></A>
The Java code in a compilation unit must be legal Java code (or legal
code in the Java extension, such as MultiJava, selected by any options);
in particular it must obey all of Java's static restrictions.
For example, at most one of the type definitions in a compilation unit
may be declared <CODE>public</CODE>.
See the <CITE>Java Language Specification</CITE> <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A> 
for details.
</P><P>

<A NAME="IDX1086"></A>
<A NAME="IDX1087"></A>
As in Java, JML can be implemented
using files to store compilation units.  When this is done there must also
be a correspondence between the name of any public type defined in a
compilation unit and the file name.  This is done exactly as in Java,
although JML allows additional file name suffixes.
See section <A HREF="jmlrefman_16.html#SEC194">16.1 File Name Suffixes</A>, for details on the file name suffixes
allowed in JML.
</P><P>

<A NAME="IDX1088"></A>
The specification of the compilation unit consists of the
specifications of the <VAR>top-level-definition</VAR>s it contains, placed in
the declared package (if any).  The interface part of this specification is
determined as in Java <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A> (or as in the Java extension used).
The specifications of each <VAR>type-definition</VAR> are computed by starting
from an environment that contains the declared package (if any),
each top-level definition in the compilation unit (to allow for
mutual recursion), and the imports <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A>.
In JML, not only is the package <CODE>java.lang</CODE> implicitly imported, but also
there is an implicit model import of <CODE>org.jmlspecs.lang</CODE>.
(See section <A HREF="jmlrefman_5.html#SEC34">5.2 Import Definitions</A>, for the meaning of a model import.)
</P><P>

<A NAME="IDX1089"></A>
Ignoring refinement,
a Java compilation unit satisfies such a JML specification if it
satisfies the specified <VAR>package-definition</VAR> (if any), and if
for each specified <VAR>type-definition</VAR>, there
is a corresponding Java <VAR>type-definition</VAR> that satisfies that
type's JML specification. 
Furthermore, if the JML specification does not contain a
public type, then the Java compilation unit may not contain a public
type.
</P><P>

The syntax and semantics of <VAR>package-definition</VAR>s and
<VAR>import-definition</VAR>s are discussed in the subsections below.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="jmlrefman_5.html#SEC33">5.1 Package Definitions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="jmlrefman_5.html#SEC34">5.2 Import Definitions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Package Definitions"></A>
<HR SIZE="6">
<A NAME="SEC33"></A>
<H2> 5.1 Package Definitions </H2>
<!--docid::SEC33::-->
<P>

<A NAME="IDX1090"></A>
The syntax of a <VAR>package-definition</VAR> is as in Java <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A>.
</P><P>

<A NAME="IDX1091"></A>
<A NAME="IDX1092"></A>
<A NAME="IDX1093"></A>
<A NAME="IDX1094"></A>
<A NAME="IDX1095"></A>
<A NAME="IDX1096"></A>
<A NAME="IDX1097"></A>
<TABLE><tr><td>&nbsp;</td><td class=display><pre style="font-family: serif"><VAR>package-definition</VAR> ::= <CODE>package</CODE> <VAR>name</VAR> <CODE>;</CODE>
<VAR>name</VAR> ::= <VAR>ident</VAR>  [ <CODE>.</CODE> <VAR>ident</VAR> ] <small>...</small>
</pre></td></tr></table></P><P>

<A NAME="IDX1098"></A>
<A NAME="IDX1099"></A>
A Java package definition satisfies the JML specification only if it
is the same as that specified.  That is, the Java code has
to be the same (modulo <VAR>white-space</VAR>) as the JML specification.
</P><P>

<A NAME="Import Definitions"></A>
<HR SIZE="6">
<A NAME="SEC34"></A>
<H2> 5.2 Import Definitions </H2>
<!--docid::SEC34::-->
<P>

<A NAME="IDX1100"></A>
The syntax of a <VAR>import-definition</VAR> is as follows.
The only difference from the Java syntax <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A>
is the optional <CODE>model</CODE> modifier.
</P><P>

<A NAME="IDX1101"></A>
<A NAME="IDX1102"></A>
<A NAME="IDX1103"></A>
<A NAME="IDX1104"></A>
<A NAME="IDX1105"></A>
<A NAME="IDX1106"></A>
<A NAME="IDX1107"></A>
<A NAME="IDX1108"></A>
<A NAME="IDX1109"></A>
<A NAME="IDX1110"></A>
<TABLE><tr><td>&nbsp;</td><td class=display><pre style="font-family: serif"><VAR>import-definition</VAR> ::= [ <CODE>model</CODE> ] <CODE>import</CODE> <VAR>name-star</VAR> <CODE>;</CODE>
<VAR>name-star</VAR> ::= <VAR>ident</VAR> [ <CODE>.</CODE> <VAR>ident</VAR> ] <small>...</small> [ <CODE>.</CODE> <CODE>*</CODE> ]
</pre></td></tr></table></P><P>

<A NAME="IDX1111"></A>
An <VAR>import-definition</VAR> may use the <CODE>model</CODE> modifier
if and only if the whole <VAR>import-definition</VAR> is entirely contained
within a single annotation. For example, the following is illegal.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=display><pre style="font-family: serif"><CODE>/*@ model @*/ import com.foo.*; // illegal!</CODE> 
</pre></td></tr></table></P><P>

To write an import that affects both the JML annotations and Java
code, just use a normal java import, without using the <CODE>model</CODE>
modifier.
</P><P>

The effect on the interface computed for a compilation unit of an
<VAR>import-definition</VAR> without the <CODE>model</CODE> 
keyword is the same as in Java <A HREF="jmlrefman_27.html#BIB30">[Gosling-etal00]</A>.  Such import
directives affect the computation of the interface of the Java code as
well as the JML specification (that is, they apply to both equally).
</P><P>

<A NAME="IDX1112"></A>
<A NAME="IDX1113"></A>
<A NAME="IDX1114"></A>
When the <CODE>model</CODE> keyword is used, 
the import only has an effect on the JML annotations (and not on the
Java code).  The abbreviation permitted by the use of such an import,
however, is the same as would be effected by a normal Java import.
Such model imports can affect the computation of the interface
of the JML specification by being used in the declarations of model
and ghost features.
</P><P>

Both normal Java and model imports do not themselves contribute to the
interface of a JML specification.  As such, they do not have to be
present in a correct implementation of the specification.  An
implementation could, for example, use different forms of import, or
it could use fully qualified names instead of imports, and achieve the
same effect as using the imports in the specification.
</P><P>

<A NAME="Type Definitions"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_5.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_6.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_28.html#SEC247">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="jmlrefman_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
by <I>Gary Leavens</I> on <I>January, 9  2008</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
